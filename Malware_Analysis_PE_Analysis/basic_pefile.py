#Import libraries
import pefile
import csv
pe = pefile.PE("/home/monty/Desktop/malware_data_science_entrypoints_redacted/malware_data_science/ch2/ircbot.exe")
#Creating a flag.
not_done = False
#A while loop for testing for user input.
while not not_done:
    #Asking the user what they would like to do with the malware.
    user_input = input("Enter \'s\' if you Would you like to show the sections "+
    "\nEnter \'DLL\' if you would like to show the DLL binaries: ")
    #Handling the case where the user enters s.
    if user_input.lower() == 's':
        #Printing a message for the user.
        print("Now printing the section info: \n\n\n")
        #Parsing the executable.
        for section in pe.sections:
            malicious_output = section.Name,hex(section.VirtualAddress), hex(section.Misc_VirtualSize), section.SizeOfRawData
            print(malicious_output)
    #Handling the case where
    elif user_input.lower() == 'dll':
        #Printing a message for the user.
        print("Now printing the dll info: \n\n\n")
        #Parsing the file for dll.
        for entry in pe.DIRECTORY_ENTRY_IMPORT:
            print(entry.dll)
            for function in entry.imports:
                print('\t',function.name)
