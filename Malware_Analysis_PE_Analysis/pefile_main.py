#Importing the pefile library.
import pefile
#assigning the read malware file to the variable pe.
pe = pefile.PE("/home/monty/Desktop/malware_data_science/ch1/ircbot.exe")
#Creating a blank list.
my_list = []
#Adding pe to a list to make it iterable.
my_list.append(pe)
#Setting a flag.
not_done = False
#Testing for user input.
while not not_done:
    #Asking the user what they would like to do.
    user_choice = input("Enter \'p\' to parse the ircbot file.\n"+
    "Enter \'dll\' to parse the dll info.\nEnter \'e\' to exit the program: ")
    #Handling the case where the user enters p.
    if user_choice.lower() == 'p':
        #Printing out the section info for the malware.
        for section in pe.sections:
            print(section.Name, hex(section.VirtualAddress), hex(section.Misc_VirtualSize), section.SizeOfRawData)
    #Handling the case where the user enters dll.
    elif user_choice.lower() == "dll":
        for entry in pe.DIRECTORY_ENTRY_IMPORT:
            print(entry.dll)
            for function in entry.imports:
                print("\t",function.name)
    #Handling the case where the user enters e.
    elif user_choice.lower() == 'e':
        #Setting flag to true to break from the loop.
        not_done = True
    #Handling the case where the input is not understood.
    else:
        print(f"Sorry, but, \'{user_choice}\' is an invalid entry, please try again!")